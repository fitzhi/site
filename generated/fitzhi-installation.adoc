= STARTING WITH FITZHÌ
:nofooter:

== OVERVIEW

The architecture of Fitzhì is quite simple.

* A Javascript frontend which might be launched from a remote host
* A Backend which has to be installed on a computer inside your network.


[graphviz, "main"]
....
digraph G {
  { 
    subgraph clusterFrontend { 
        margin=20
        label="Frontend"
        node [margin=0.1 fontcolor=black fontsize=12 width=0.5 shape=rectangle style=filled]
        f [fillcolor="#28a745" label="Angular frontend"]
        s1 [fillcolor=lightGrey label="Sonar server 1"]
        sn [fillcolor=whiteSmoke fontcolor=darkGrey label="Sonar server (n)"]
    }

    subgraph clusterBackend { 
        margin=30
        label="backend"

        node [margin=0.1 fontcolor=black fontsize=12 width=0.5 shape=rectangle style=filled]
        b [fillcolor="#28a745" label="Spring Boot backend"]

        node [margin=0.1 fontcolor=black fontsize=12 width=0.5 shape=folder style=filled]
        d [fillcolor=grey label=<<font point-size="16">Fitzhì data</font><br/>in JSON format>]
        
        node [margin=0.1 fontcolor=darkGrey fontsize=12 width=0.5 shape=folder style="filled"]
        temp [fillcolor=whiteSmoke label=<<I>GIT local repository<br/>(in temp folders)</I>>]

        node [margin=0.1 fontcolor=black fontsize=12 shape=rectangle width=0.5 style="filled"]
        git [label="GitHub, GitLab..."]
    }
  }
  sn -> f [color="grey" style="dotted"]
  s1 -> f
  f -> {b} [dir=both]
  b -> temp [color="grey" style="dotted"]
  b -> {d}
  git -> b

}
....

== INSTALLATION

First of all, you will need to export the GitHub repository.

. Download fitzhì
[source, shell]
----
git clone https://www.github.com/fitzhi/application.git
rm -rf .git
----

A directory Application will be downloaded with this content :

* front-fitzhi (the Angular front-end project)
* back-fitzhi  (the Spring back-end project)

=== BACK-END INSTALLATION

fitzhì has the following prerequisites:::
* Java 8 or higher
* Maven 3 or higher
* Git 2 or higher installed on the back-end server


The installation of the back-end is very simple. Just type :

[source, shell]
----
cd application
./init.sh
----

|===
|Directory |Version
|deploy
|Main deployment directory
|deploy/backend-fitzhi
|the directory of the executable fitzhì.jar
|deploy/data
|the data directories used by fitzhì
|deploy/data/application
|the data directories where your corporate data will be stored (e.g. staff.json, project.json & skill.json). All of your updates will be stored there.
|deploy/data/referential
|the referential data which contains the static data used by the application
|===

You can copy the deploy directory on a remote server, or leave it, on your machine, for testing purpose.
The back-end URL, therefore, will be http://localhost:8080 


To start the back-end fitzhì, just type:
[source, shell]
----
./run.sh
----

To test if the server is started, just visit the url http://localhost:8080/api/test/ping[window=_blank] , or http://<<hostname>>:8080/api/test/ping  +
A **Pong** response is expected.


=== FRONT-END INSTALLATION

The easiest installation involved no-installation. +
The last stable release of front-fitzhì is available here https://fitzhi.github.io/spoq[window=_blank]. +
This URL hosts only a static web server which delivers JS files. So just go there.

If you prefer to deploy the front-end on-premise, like any other Angular application. +
Just type 
[source, shell]
----
cd front-fitzhi
npm install
ng build --prod 
----

A *dist* (by default) directory will be created. +
Just copy everything within the output folder to a folder on your server.
For more precision, just RTFM, https://angular.io/guide/deployment

 
== FIRST START OF FITZHI

The common sense might consider that there can be *only* one first launch. 
In fact, *two* are available for Fitzhì : the first launch and the *very* first launch. +


=== THE VERY FIRST START
The first ever user inside Fitzhì will be the first administrative user, and therefore its owner. +
_At the beginning, God enters in Fitzhì and performs all initialization_. +
Fitzhì detects the first ever interaction & creates the file **connection.txt** to save & _(in a way)_ celebrate this first connection. +
Then you just have to follow the steppers +

image::/assets/img/installation/very-first-connection-1.png[600,500]

IMPORTANT: The first panel saves in the permanent local storage the URL of your backend server. Default is localhost:8080. You will have to remove this entry if you plan to move this server _(an entry in the backlog will simplify this operation)_.

=== THE FIRST START 
Each user in Fitzhì will experience a first launch. +
Depending on a property set in file `*application.properties*`, Fitzhi users can self-register themselves, or not. If not, they have to be already created _(Yogi Berrism, Una perogrullada, Une verità lapalissiana, une lapalissade, Een waarheid als een koe, Tårta på tårta)_. + 
Default settings allow the self-registration.

[source]
....
#
# Does Fitzhì allow self registration ?
# Either, everyone can create his own user, by simply connecting to the Fitzhi URL
# Or a login must be already present for each new user in the staff collection.
#
allowSelfRegistration=true
....

